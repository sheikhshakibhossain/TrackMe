<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Now | Abid</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="favicon.png">

    <style>
        /* General Body Styles */
        body {
            background: #121212;
            color: #f0f0f0;
            font-family: 'Orbitron', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            /* Center horizontally */
            justify-content: center;
            /* Center vertically */
            min-height: 100vh;
            margin: 0;
            overflow-x: hidden;
            text-align: center;
            padding: 20px;
            box-sizing: border-box;
        }

        h1 {
            font-size: 2.5em;
            color: #00e6e6;
            font-weight: 700;
            margin-bottom: 20px;
            text-shadow: 0 0 25px rgba(0, 255, 255, 0.8);
        }

        #currentActivity {
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 255, 255, 0.5);
            width: 95%;
            max-width: 90%;
            color: #fff;
            animation: fadeIn 1s ease-out;
            box-sizing: border-box;
            overflow-y: auto;
            max-height: 70vh;
            margin-left: 5%;
            /* Remove margin-bottom as it's handled by flexbox now */
        }

        /* Add a wrapper for vertical centering if needed */
        .content-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex-grow: 1;
            /* Allow content to take up available space */
            justify-content: center;
            /* Center vertically within wrapper */
        }

        .activity-summary {
            font-size: 1.8em;
            color: #00e6e6;
            font-weight: 700;
            margin-bottom: 10px;
            letter-spacing: 1px;
        }

        .activity-text {
            font-size: 1.4em;
            font-weight: 400;
            color: rgba(0, 255, 255, 0.8);
            line-height: 1.4;
        }


        /* Icon Container */
        .icon-container {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            animation: rotate 15s infinite linear;
        }

        .icon-container svg {
            width: 100px;
            height: 100px;
            margin: 15px;
            fill: #00e6e6;
        }

        /* Keyframes */
        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }
    </style>
</head>

<body>
    <div>
        <h1>hello _</h1>

        <!-- Rotating Mars Rover Icon -->
        <div class="icon-container">
            <!-- Mars Rover SVG icon -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64">
                <path
                    d="M50.3 23.4l4.7-5.1c.6-.7.5-1.8-.2-2.4l-4.2-2.8c-.7-.5-1.8-.4-2.4.2l-3.5 4.1-6.2-4.7c-.6-.5-1.4-.5-2 0l-8.5 6.4c-.7.5-.9 1.3-.4 2 .5.7 1.3.9 2 .4l7.6-5.6c.4-.3.9-.3 1.4 0l8.6 6.4c.6.4 1.5.5 2.1-.1l3.9-5.6c.5-.8.5-1.7-.1-2.5zM11.3 40c-.7-.5-1.8-.4-2.4.2l-4.2 2.8c-.7.6-.7 1.7-.1 2.4l4.7 5.1c.6.7 1.7.7 2.4.1l3.5-4.1 6.2 4.7c.6.5 1.4.5 2 0l8.5-6.4c.7-.5.9-1.3.4-2-.5-.7-1.3-.9-2-.4l-7.6 5.6c-.4.3-.9.3-1.4 0l-8.6-6.4c-.6-.4-1.5-.5-2.1.1l-3.9 5.6c-.5.8-.5 1.7.1 2.5z" />
            </svg>
        </div>

        <!-- Current Activity Section -->
        <div id="currentActivity">
            <div class="activity-summary">
                <span></span>
            </div>
            <div id="activityText" class="activity-text">Loading...</div>
        </div>
    </div>

    <script>
        async function loadExcel() {
            try {
                const response = await fetch('routine.xlsx');
                const arrayBuffer = await response.arrayBuffer();

                const workbook = XLSX.read(arrayBuffer, { type: 'array' });
                const firstSheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[firstSheetName];

                const jsonData = XLSX.utils.sheet_to_json(worksheet);
                checkCurrentActivity(jsonData);
            } catch (error) {
                console.error('Error loading Excel file:', error);
            }
        }

        function formatDay(day1, day2) {
            const days = {
                "Mon": "Monday",
                "Tue": "Tuesday",
                "Wed": "Wednesday",
                "Thu": "Thursday",
                "Fri": "Friday",
                "Sat": "Saturday",
                "Sun": "Sunday"
            };
            const formattedDays = [day1, day2].map(day => days[day] || day).filter(Boolean);
            return formattedDays.join(', ') || "";
        }

        function formatTime(time1, time2) {
            if (time1 === time2) {
                return time1 || "";
            }
            return [time1, time2].filter(Boolean).join(' / ') || "";
        }

        function getCurrentDay() {
            const days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
            const currentDate = new Date();
            return days[currentDate.getDay()];
        }

        function getCurrentTime() {
            const currentDate = new Date();
            const hours = currentDate.getHours().toString().padStart(2, '0');
            const minutes = currentDate.getMinutes().toString().padStart(2, '0');
            return `${hours}:${minutes}`;
        }

        function timeToMinutes(time) {
            let [hours, minutes, period] = time.split(':');
            hours = parseInt(hours, 10);
            minutes = parseInt(minutes, 10);

            if (period === "PM" && hours !== 12) hours += 12;
            if (period === "AM" && hours === 12) hours = 0;

            return hours * 60 + minutes;
        }

        function checkCurrentActivity(scheduleData) {
            const currentDay = getCurrentDay();
            const currentTime = getCurrentTime();

            var currentActivity = "I'm not available right now. Drop me an <a href='mailto:abid@cse.uiu.ac.bd' style='color: inherit; font-weight: bold; text-decoration: underline;'>email</a> if you need anything.";

            for (const row of scheduleData) {
                const day = formatDay(row.Day1, row.Day2);
                const timeframe = formatTime(row.Time1, row.Time2);

                const [startTime, endTime] = timeframe.split(' - ').map(time => time.trim());
                const startMinutes = timeToMinutes(startTime);
                const endMinutes = timeToMinutes(endTime);
                const currentMinutes = timeToMinutes(currentTime);

                const officeStart = timeToMinutes('08:30');
                const officeEnd = timeToMinutes('04:30');

                if (day.includes(currentDay) && currentMinutes >= startMinutes && currentMinutes <= endMinutes) {
                    currentActivity = `Currently, I'm taking ${row.Title} course at ClassRoom(${row.Room1 || row.Room2 || ""}).`;
                    break;
                } else if (day.includes(currentDay) && currentMinutes >= officeStart && currentMinutes <= officeEnd) {
                    currentActivity = `I'm available in my office (Room:619). In case you don't find me there, I'm just a call away.`;
                } else if (day.includes(currentDay)) {
                    currentActivity = "My class and office hours have endedðŸ’¤, I am not at UIU right now. If you need to say something, please send me an <a href='mailto:abid@cse.uiu.ac.bd' style='color: inherit; font-weight: bold; text-decoration: underline;'>email</a>.";
                }
            }

            document.getElementById('activityText').innerHTML = currentActivity;
        }



        // Load the Excel file on page load
        loadExcel();
    </script>
</body>

</html>